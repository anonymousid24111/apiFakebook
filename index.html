<!DOCTYPE html>
<html>

<head>
   <title>Hello world</title>
</head>

<script src="/socket.io/socket.io.js"></script>
<script>
   var socket = io();
   function joinchat() {
      socket.emit('joinchat', { room: document.getElementById('room').value });
   };
   function sendcontent() {
      var sender = document.getElementById('sender').value;
      var receiver = document.getElementById('receiver').value;
      var content = document.getElementById('content').value;
      var room = document.getElementById('room').value;
      var conversation_id = document.getElementById('conversation_id').value;
      if (1) {
         console.log(sender, receiver, content, conversation_id, room)
         socket.emit('send', { sender, receiver, content, conversation_id, room });
         document.getElementById('content').value = "";
      }
   }
   socket.on('joinedchat', function (data) {
      var a = "";
      data.chats && data.chats.map(e => {
         a += '<div>' + e.sender + ' sent a\
          content to '+ e.receiver + ': ' + e.content + '</div>'
      })
      // sender = data.sender;
      document.body.innerHTML = '<div>Sender: <input type = "text" id = "sender"></div>\
      <div>Receiver: <input type = "text" id = "receiver"></div>\
      <div>content: <input type = "text" id = "content"></div>\
      <div>Conversation_id: <input type = "text" id = "conversation_id"></div>\
      <div>Room: <input type = "text" id = "room" value='+ data.room + '>\
         <button type = "button" name = "button" onclick = "sendcontent()">Send</button>\
         <div id = "content-container"></div>\
         <div id="chat">'+ a + '</div>';
   });
   socket.on("reconnecting", data => {
      console.log("reconnecting");
   })

   socket.on("oncontent", data => {
      console.log("oncontent" + data)
      document.getElementById('chat').innerHTML += '<div>' + data.sender + ' sent a\
          content to '+ data.receiver + ': ' + data.content + '</div>'
   })
</script>

<body>
   <input id="room" type="text" name="room" value="" placeholder="Enter your room!">
   <button type="button" name="button" onclick="joinchat()">
      Join a room to chat!
   </button>

</body>

</html>